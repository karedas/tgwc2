<ng-container *ngIf="!showAccordionView">
  <ng-container *ngTemplateOutlet="tabView"></ng-container>
</ng-container>

<ng-container *ngIf="showAccordionView">
  <ng-container *ngTemplateOutlet="accordion"></ng-container>
</ng-container>


<ng-template #tabView>

  <div class="tg-smart-equipinv">
    <div fxLayout="column" fxFlex="0 1 100%">
      <div class="tg-smart-tabtitle" fxLayout="row" fxFlex="0 0 auto" fxLayoutGap="5px">
        <div fxFlex="1 0 auto" (click)="onCollapse()">
          <ng-container *ngIf="show; else headerCollapsed">
            <div [ngClass]="{'active': tab === 1}" fxFlex="0 0 auto" fxFlexAlign="center"
              class="tg-smart-btn-container">
              <button mat-button class="tg-smart-title"
                (click)="onTabClick('equipaggiamento', 1, $event)">Equipaggiamento</button>
            </div>
            <div [ngClass]="{'active': tab === 2}" fxFlex="0 0 auto" fxFlexAlign="center"
              class="tg-smart-btn-container">
              <button mat-button class="tg-smart-title"
                (click)="onTabClick('inventario', 2, $event)">Inventario</button>
            </div>
          </ng-container>
        </div>

        <ng-template #headerCollapsed>
          <div fxFlex="1 0 auto" fxFlexAlign="center">
            <button mat-button class="tg-smart-title tg-lt-yellow" style="width: 100%">
              Mostra equipaggiamento e inventario
            </button>
          </div>
        </ng-template>

        <button mat-icon-button aria-label="Apri / Chiudi" class="tg-smart-collapsebtn" (click)="onCollapse()"
          #collapsebutton>
          <mat-icon>{{show ? 'keyboard_arrow_down' : 'keyboard_arrow_right'}}</mat-icon>
        </button>

      </div>
      <div fxFlex="1 0 auto" class="equinv-container" *ngIf="show">
        <ng-scrollbar class="scrollbar" [ngClass]="{'disabled': draggingSplitArea}" [disabled]="draggingSplitArea"
          fxFlex="1 1 100%" fxFlexFill>

          <div class="eqinv-wrapper-list" fxLayout="column" *ngIf="equip && tab === 1">
            <ng-container *ngIf="equip.length > 0; else noequip">

              <div class="objlist-caption" fxLayout="row" fxFlex="0 0 auto">
                <div fxFlex="0 0 20%" fxLayoutAlign="start center">Dove</div>
                <div fxFlex="0 0 65%" fxLayoutAlign="start center">Oggetto</div>
                <div fxFlex="0 0 15%" fxLayoutAlign="start center">Peso</div>
              </div>

              <div fxLayout="column" fxFlex="0 1 100%">
                <div class="eqinv-wrapper-list" fxLayout="column">

                  <div fxFlex="1 0 auto" class="eqinv-item-wrap" *ngFor="let item of equip"
                    (click)="interactElement(item)">
                    <div fxFlex="1 0 auto" *ngIf="equipPositionValue[(item.eq[0] - 1)][1]; let pos" class="eqinv-item">
                      <div class="eqinv-item-position" fxFlex="0 0 20%" fxLayoutAlign="flex-start center">
                        <span class="tg-yellow">{{pos}}</span>
                      </div>
                      <div class="eqinv-item" fxFlex="0 0 65%" fxLayoutAlign="flex-start center"
                        tooltip="Guarda {{item.desc | dataToHtml}}" placement="top" show-delay="500"
                        animation-duration="0">
                        <tg-icons [icon]="item.icon"></tg-icons>
                        <tg-hstat [condprc]="item.condprc"></tg-hstat>
                        <span [innerHtml]="item.desc | dataToHtml | capitalizeFirst" class="eqinv-item-text"></span>
                      </div>
                      <div class="eqinv-item-weight" fxFlex="0 0 15%" fxLayoutAlign="flex-start center">{{item.wgt}}pt
                      </div>
                    </div>
                  </div>

                </div>
              </div>

            </ng-container>
          </div>

          <div class="eqinv-wrapper-list" fxLayout="column" *ngIf="inventory && tab === 2">
            <ng-container *ngIf="inventory.length > 0; else noinv">

              <div class="objlist-caption" fxLayout="row">
                <div fxFlex="0 0 60%" fxLayoutAlign="flex-start center">Oggetto</div>
                <div fxFlex="0 0 20%" fxLayoutAlign="flex-start center">Quantità</div>
                <div fxFlex="0 0 20%" fxLayoutAlign="flex-start center">Peso</div>
              </div>

              <div fxLayout="column" fxFlex="0 1 100%">
                <div class="eqinv-wrapper-list" fxLayout="column">
                  <div fxFlex="1 0 auto" class="eqinv-item-wrap" *ngFor="let item of inventory"
                    (click)="interactElement(item, true)">
                    <div class="eqinv-item" fxFlex="0 0 60%" fxLayoutAlign="flex-start center"
                      tooltip="Guarda {{item.desc | dataToHtml}}" placement="top" show-delay="500"
                      animation-duration="0">
                      <tg-icons [icon]="item.icon"></tg-icons>
                      <tg-hstat [condprc]="item.condprc"></tg-hstat>
                      <span [innerHtml]="item.desc | capitalizeFirst| dataToHtml"></span>
                    </div>
                    <div class="eqinv-item-qty" fxFlex="0 0 20%" fxLayoutAlign="flex-start center">
                      {{item.sz || '1'}}
                    </div>
                    <div class="eqinv-item-weight" fxFlex="0 0 20%" fxLayoutAlign="flex-start center">
                      {{item.wgt}} pt</div>
                  </div>
                </div>
              </div>

            </ng-container>
          </div>

        </ng-scrollbar>

      </div>
    </div>
  </div>

</ng-template>

<ng-template #accordion>
  <mat-accordion [displayMode]="'flat'" multi="true" class="tg-objects-list">
    <mat-expansion-panel [expanded]="true">

      <mat-expansion-panel-header collapsedHeight="auto" expandedHeight="auto">
        <mat-panel-title>
          Equipaggiamento
        </mat-panel-title>
        <mat-panel-description>
        </mat-panel-description>
      </mat-expansion-panel-header>

      <div class="eqinv-wrapper-list" fxLayout="column" *ngIf="equip">
        <ng-container *ngIf="equip.length > 0; else noequip">

          <div class="objlist-caption" fxLayout="row" fxFlex="0 0 auto">
            <div fxFlex="0 0 20%" fxLayoutAlign="start center">Dove</div>
            <div fxFlex="0 0 65%" fxLayoutAlign="start center">Oggetto</div>
            <div fxFlex="0 0 15%" fxLayoutAlign="start center">Peso</div>
          </div>

          <div fxLayout="column" fxFlex="0 1 100%">
            <div class="eqinv-wrapper-list" fxLayout="column">

              <div fxFlex="1 0 auto" class="eqinv-item-wrap" *ngFor="let item of equip" (click)="interactElement(item)">
                <div fxFlex="1 0 auto" *ngIf="equipPositionValue[(item.eq[0] - 1)][1]; let pos" class="eqinv-item">
                  <div class="eqinv-item-position" fxFlex="0 0 20%" fxLayoutAlign="flex-start center">
                    <span class="tg-yellow">{{pos}}</span>
                  </div>
                  <div class="eqinv-item" fxFlex="0 0 65%" fxLayoutAlign="flex-start center"
                    tooltip="Guarda {{item.desc | dataToHtml}}" placement="top" show-delay="500" animation-duration="0">
                    <tg-icons [icon]="item.icon"></tg-icons>
                    <tg-hstat [condprc]="item.condprc"></tg-hstat>
                    <span [innerHtml]="item.desc | dataToHtml | capitalizeFirst" class="eqinv-item-text"></span>
                  </div>
                  <div class="eqinv-item-weight" fxFlex="0 0 15%" fxLayoutAlign="flex-start center">{{item.wgt}}pt
                  </div>
                </div>
              </div>

            </div>
          </div>

        </ng-container>
      </div>

    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="true">
      <mat-expansion-panel-header collapsedHeight="auto" expandedHeight="auto">
        <mat-panel-title>
          Inventario
        </mat-panel-title>
        <mat-panel-description>
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="eqinv-wrapper-list" fxLayout="column" *ngIf="inventory">
        <ng-container *ngIf="inventory.length > 0; else noinv">

          <div class="objlist-caption" fxLayout="row">
            <div fxFlex="0 0 60%" fxLayoutAlign="flex-start center">Oggetto</div>
            <div fxFlex="0 0 20%" fxLayoutAlign="flex-start center">Quantità</div>
            <div fxFlex="0 0 20%" fxLayoutAlign="flex-start center">Peso</div>
          </div>

          <div fxLayout="column" fxFlex="0 1 100%">
            <div class="eqinv-wrapper-list" fxLayout="column">
              <div fxFlex="1 0 auto" class="eqinv-item-wrap" *ngFor="let item of inventory"
                (click)="interactElement(item, true)">
                <div class="eqinv-item" fxFlex="0 0 60%" fxLayoutAlign="flex-start center"
                  tooltip="Guarda {{item.desc | dataToHtml}}" placement="top" show-delay="500" animation-duration="0">
                  <tg-icons [icon]="item.icon"></tg-icons>
                  <tg-hstat [condprc]="item.condprc"></tg-hstat>
                  <span [innerHtml]="item.desc | capitalizeFirst| dataToHtml"></span>
                </div>
                <div class="eqinv-item-qty" fxFlex="0 0 20%" fxLayoutAlign="flex-start center">
                  {{item.sz || '1'}}
                </div>
                <div class="eqinv-item-weight" fxFlex="0 0 20%" fxLayoutAlign="flex-start center">
                  {{item.wgt}} pt</div>
              </div>
            </div>
          </div>

        </ng-container>
      </div>
    </mat-expansion-panel>

  </mat-accordion>
</ng-template>



<ng-template #noinv>
  <span class="no-items-notice">Non hai niente nel tuo inventario!</span>
</ng-template>
<ng-template #noequip>
  <span class="no-items-notice">Non indossi nulla!</span>
</ng-template>
